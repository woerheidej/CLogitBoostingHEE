% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CLogitBoostHEE.R
\name{CLogitBoostHEE}
\alias{CLogitBoostHEE}
\title{Detect Heterogeneous Exposure Effects via Boosting and Stability Selection}
\usage{
CLogitBoostHEE(
  data,
  exposure = NULL,
  strata = "strata",
  outcome = "y",
  matching = NULL,
  q = NULL,
  PFER = NULL,
  cutoff = NULL,
  nu = 1,
  mstop = 2000,
  B = 50,
  sampling_type = "SS",
  assumption = "r-concave",
  n_cores = 1,
  df_bols = 1,
  df_bbs = 1,
  intercept = FALSE,
  center = TRUE,
  flexible = TRUE,
  reduction_scaler = 1,
  early_stopping = TRUE,
  save_cv = FALSE
)
}
\arguments{
\item{data}{A \code{data.frame} containing the outcome, exposure, covariates,
strata, and matching variables.}

\item{exposure}{Character string giving the exposure variable name.
Can be set to \code{NULL} for detection of heterogeneous effects in general.}

\item{strata}{Character string giving the strata variable used for a
matched case–control design.}

\item{outcome}{Character string giving the outcome variable name in
the original data.}

\item{matching}{Character vector of variable names used for matching.
These variables are excluded from the predictor set.}

\item{q}{Numeric giving the number of variables to select in each
boosting iteration.}

\item{PFER}{Numeric giving the per-family error rate for stability
selection.}

\item{cutoff}{Numeric giving the selection probability cutoff for
stability selection. Exactly two of \code{q}, \code{PFER}, and \code{cutoff}
must be specified.}

\item{nu}{Numeric giving the boosting step size (learning rate,
default \code{1}).}

\item{mstop}{Integer giving the maximum number of boosting iterations
(default \code{2000}).}

\item{B}{Integer giving the number of complementary pairs used for
stability selection (default \code{50}).}

\item{sampling_type}{Character string specifying the stability selection
scheme: \code{"SS"} for Shah & Samworth complementary pairs stability
selection or \code{"MB"} for the original Meinshausen & Bühlmann approach
(default \code{"SS"}).}

\item{assumption}{Character string specifying the error-bound assumption
used for complementary pairs stability selection. One of \code{"none"},
\code{"unimodal"}, or \code{"r-concave"} (default \code{r-concave}).}

\item{n_cores}{Integer giving the number of CPU cores used for parallel
stability selection (default \code{1}). Be careful when choosing more than one core
in scenarios with multiple thousands of observations or hundreds of parameters
due to RAM bottleneck.}

\item{df_bols}{Integer giving the degrees of freedom for linear base
learners.}

\item{df_bbs}{Integer giving the degrees of freedom for smooth base
learners.}

\item{intercept}{Logical indicating whether base learners should include
an intercept (default \code{FALSE}).}

\item{center}{Logical indicating whether continuous variables should be
centered during preprocessing (default \code{TRUE}).}

\item{flexible}{Logical indicating whether both linear and smooth base
learners are included for continuous covariates (default \code{TRUE}).}

\item{reduction_scaler}{Numeric used to scale the reduced \code{mstop} in
stability selection according to
\code{q * 5 * (1 / nu) * reduction_scaler}.}

\item{early_stopping}{Logical indicating whether the offset model should
be refined via early stopping. Can be disabled for high-dimensional
data to reduce runtime (default \code{TRUE}).}

\item{save_cv}{Logical indicating whether the cross-validated early stopping
object should be saved for later analysis.}
}
\value{
A \code{stabsel} object containing the selected variables and their
selection probabilities.
}
\description{
Fits a component-wise gradient boosting model with optional
interactions for exposure effect heterogeneity and performs
stability selection on the fitted model.
}
\details{
This function automates preprocessing (scaling continuous covariates
and converting categorical covariates to factors), generates the
boosting formula, computes offsets if needed, fits a \code{gamboost}
model, and applies stability selection using \code{stabsel}.
}
\examples{
\dontrun{
data(sim)
sim_results <- CLogitBoostHEE(
  sim$data,
  exposure = "X",
  strata = "strata",
  outcome = "y",
  matching = "s",
  q = 5,
  PFER = 0.1,
  cutoff = NULL
)
}

}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CLogitBoostingHEE.R
\name{CLogitBoostingHEE}
\alias{CLogitBoostingHEE}
\title{Detect Heterogeneous Exposure Effects via Boosting and Stability Selection}
\usage{
CLogitBoostingHEE(
  data,
  exposure = NULL,
  response = "resp",
  strata = "strata",
  outcome = "y",
  matching = NULL,
  q = NULL,
  PFER = NULL,
  cutoff = NULL,
  nu = 1,
  mstop = 1000,
  B = 50,
  sampling_type = "SS",
  assumption = "none",
  stabsel_cores = 1,
  df_bols = 1,
  df_bbs = 1,
  intercept = FALSE,
  center = TRUE,
  flexible = TRUE,
  reduction = 10
)
}
\arguments{
\item{data}{A \code{data.frame} containing the outcome, exposure, covariates,
strata, and matching variables.}

\item{exposure}{Character string giving the exposure variable name.}

\item{response}{Character string for the response variable used in
boosting (default \code{"resp"}). Typically a two-column matrix with
outcome and strata.}

\item{strata}{Character string giving the strata variable used for
matched case-control design.}

\item{outcome}{Character string giving the outcome variable name
in the original data.}

\item{matching}{Character vector of variable names used for matching.
These are excluded from predictors.}

\item{q}{Number of variables to select in each boosting iteration.}

\item{PFER}{Per-family error rate for stability selection.}

\item{cutoff}{Selection probability cutoff for stability selection.
Exactly two of \code{q}, \code{PFER}, \code{cutoff} must be specified.}

\item{nu}{Step size for boosting (learning rate, default 1).}

\item{mstop}{Maximum number of boosting iterations (default 1000).}

\item{B}{Number of complementary pairs for stability selection (default 50).}

\item{sampling_type}{Either \code{"SS"} for Shah & Samworth complementary pairs stability selection
or \code{"MB"} for the original stability selection approach bei Meinshausen & BÃ¼hlmann
(default \code{"SS"}).}

\item{assumption}{Error bound assumption for complementary pairs stability selection,
one of \code{"none"}, \code{"unimodal"}, or \code{"rconcave"}.}

\item{stabsel_cores}{Number of cores for parallel stability selection (default 1).}

\item{df_bols}{Degrees of freedom for linear base learners.}

\item{df_bbs}{Degrees of freedom for smooth base learners.}

\item{intercept}{Logical, should base learners include an intercept (default FALSE).}

\item{center}{Logical, should continuous variables be centered (default TRUE).}

\item{flexible}{Logical, if TRUE both linear and
smooth base learners are included for continuous covariates.}

\item{reduction}{Integer factor to reduce \code{mstop} for stability selection to save
computational resources.}
}
\value{
A \code{stabsel} object containing selected variables and selection
probabilities. If stability selection fails, returns \code{NULL} with a warning.
}
\description{
Fits a component-wise gradient boosting model with optional
interactions for exposure effect heterogeneity and performs
stability selection on the fitted model.
}
\details{
This function automates preprocessing (scaling continuous covariates
and converting categorical covariates to factors), generates the
boosting formula, computes offsets if needed, fits a \code{gamboost}
model, and applies stability selection using \code{stabsel}.
}
\examples{
\dontrun{
data_sim <- simulate_matched_data(...) # your custom simulation function
stab_model <- CLogitBoostingHEE(data_sim$data,
                         exposure = "X",
                         response = "resp",
                         strata = "strata",
                         outcome = "y",
                         q = 10, PFER = 1, cutoff = NULL)
}

}
